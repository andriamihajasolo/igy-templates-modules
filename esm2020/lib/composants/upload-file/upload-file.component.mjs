import { HttpEventType, HttpResponse } from '@angular/common/http';
import { Component, Input } from '@angular/core';
import { GlobalConstants } from './../../global-constants';
import * as i0 from "@angular/core";
import * as i1 from "./file-upload.service";
import * as i2 from "@angular/material/form-field";
import * as i3 from "@angular/material/toolbar";
import * as i4 from "@angular/material/button";
import * as i5 from "@angular/common";
import * as i6 from "@angular/material/input";
export class UploadFileComponent {
    constructor(uploadService) {
        this.uploadService = uploadService;
        this.showVisuelImg = false;
        this.withIcon = false;
        this.selectedFileNames = [];
        this.progressInfos = [];
        this.message = [];
        this.previews = [];
        this.imageUrl = GlobalConstants.imgURL;
    }
    ngOnInit() {
        this.imageInfos = this.uploadService.getFiles();
    }
    selectFiles(event) {
        this.message = [];
        this.progressInfos = [];
        this.selectedFileNames = [];
        this.selectedFiles = event.target.files;
        this.previews = [];
        if (this.selectedFiles && this.selectedFiles[0]) {
            const numberOfFiles = this.selectedFiles.length;
            for (let i = 0; i < numberOfFiles; i++) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    console.log(e.target.result);
                    this.previews.push(e.target.result);
                };
                reader.readAsDataURL(this.selectedFiles[i]);
                this.selectedFileNames.push(this.selectedFiles[i].name);
            }
        }
    }
    upload(idx, file) {
        this.progressInfos[idx] = { value: 0, fileName: file.name };
        if (file) {
            this.uploadService.upload(file).subscribe((event) => {
                if (event.type === HttpEventType.UploadProgress) {
                    this.progressInfos[idx].value = Math.round((100 * event.loaded) / event.total);
                }
                else if (event instanceof HttpResponse) {
                    const msg = 'Uploaded the file successfully: ' + file.name;
                    this.message.push(msg);
                    this.imageInfos = this.uploadService.getFiles();
                }
            }, (err) => {
                this.progressInfos[idx].value = 0;
                const msg = 'Could not upload the file: ' + file.name;
                this.message.push(msg);
            });
        }
    }
    uploadFiles() {
        this.message = [];
        if (this.selectedFiles) {
            for (let i = 0; i < this.selectedFiles.length; i++) {
                this.upload(i, this.selectedFiles[i]);
            }
        }
    }
}
UploadFileComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: UploadFileComponent, deps: [{ token: i1.FileUploadService }], target: i0.ɵɵFactoryTarget.Component });
UploadFileComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.3.1", type: UploadFileComponent, selector: "igy-upload-file", inputs: { showVisuelImg: "showVisuelImg", withIcon: "withIcon" }, ngImport: i0, template: "<mat-form-field>\r\n    <div class=\"main-upload\" [ngClass]=\"{'main-upload-with-icon': withIcon}\">\r\n        <img src=\"{{imageUrl}}/icons/akar-icons_circle-plus.svg\" alt=\"Plus\" *ngIf=\"withIcon\">\r\n        <mat-toolbar class=\"custom-upload\">\r\n            <input matInput [value]=\"selectedFileNames.length ? selectedFileNames : 'Choisir un fichier'\" />\r\n            <button mat-flat-button color=\"primary\" [disabled]=\"!selectedFiles\" (click)=\"uploadFiles()\">\r\n        <img src=\"{{imageUrl}}/icons/uploadFile.svg\" alt=\"Icons\">\r\n      </button>\r\n        </mat-toolbar>\r\n        <input class=\"initial-upload\" type=\"file\" id=\"fileInput\" name=\"fileInput\" accept=\"image/*\" multiple (change)=\"selectFiles($event)\" />\r\n    </div>\r\n</mat-form-field>\r\n<div *ngIf=\"showVisuelImg\" class=\"show-img-preview\">\r\n    <img *ngFor='let preview of previews' [src]=\"preview\" class=\"preview\">\r\n</div>", styles: ["mat-form-field{width:100%}:host ::ng-deep .main-upload{position:relative}:host ::ng-deep .main-upload .initial-upload{opacity:0;width:100%;height:100%;position:absolute;top:0;z-index:10}:host ::ng-deep .main-upload .custom-upload{background:transparent;flex-direction:row-reverse}:host ::ng-deep .main-upload-with-icon{text-align:center;max-width:200px;margin:auto}:host ::ng-deep .main-upload-with-icon .mat-input-element{text-align:left}:host ::ng-deep .show-img-preview{width:200px;height:200px;overflow:hidden;margin:auto}:host ::ng-deep .show-img-preview>img{width:100%;height:100%;object-fit:contain}:host ::ng-deep .mat-form-field-underline{display:none}:host ::ng-deep .mat-form-field-infix{border-bottom:none;display:flex;justify-content:center}:host ::ng-deep .mat-input-element{font-size:14px;margin-left:10px}:host ::ng-deep .mat-flat-button.mat-primary{background:transparent;padding:0;line-height:0}:host ::ng-deep .mat-toolbar-single-row{height:30px}:host ::ng-deep .mat-form-field-appearance-legacy .mat-form-field-wrapper{padding-bottom:0}\n"], components: [{ type: i2.MatFormField, selector: "mat-form-field", inputs: ["color", "appearance", "hideRequiredMarker", "hintLabel", "floatLabel"], exportAs: ["matFormField"] }, { type: i3.MatToolbar, selector: "mat-toolbar", inputs: ["color"], exportAs: ["matToolbar"] }, { type: i4.MatButton, selector: "button[mat-button], button[mat-raised-button], button[mat-icon-button],             button[mat-fab], button[mat-mini-fab], button[mat-stroked-button],             button[mat-flat-button]", inputs: ["disabled", "disableRipple", "color"], exportAs: ["matButton"] }], directives: [{ type: i5.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i5.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i6.MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["disabled", "id", "placeholder", "name", "required", "type", "errorStateMatcher", "aria-describedby", "value", "readonly"], exportAs: ["matInput"] }, { type: i5.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.3.1", ngImport: i0, type: UploadFileComponent, decorators: [{
            type: Component,
            args: [{ selector: 'igy-upload-file', template: "<mat-form-field>\r\n    <div class=\"main-upload\" [ngClass]=\"{'main-upload-with-icon': withIcon}\">\r\n        <img src=\"{{imageUrl}}/icons/akar-icons_circle-plus.svg\" alt=\"Plus\" *ngIf=\"withIcon\">\r\n        <mat-toolbar class=\"custom-upload\">\r\n            <input matInput [value]=\"selectedFileNames.length ? selectedFileNames : 'Choisir un fichier'\" />\r\n            <button mat-flat-button color=\"primary\" [disabled]=\"!selectedFiles\" (click)=\"uploadFiles()\">\r\n        <img src=\"{{imageUrl}}/icons/uploadFile.svg\" alt=\"Icons\">\r\n      </button>\r\n        </mat-toolbar>\r\n        <input class=\"initial-upload\" type=\"file\" id=\"fileInput\" name=\"fileInput\" accept=\"image/*\" multiple (change)=\"selectFiles($event)\" />\r\n    </div>\r\n</mat-form-field>\r\n<div *ngIf=\"showVisuelImg\" class=\"show-img-preview\">\r\n    <img *ngFor='let preview of previews' [src]=\"preview\" class=\"preview\">\r\n</div>", styles: ["mat-form-field{width:100%}:host ::ng-deep .main-upload{position:relative}:host ::ng-deep .main-upload .initial-upload{opacity:0;width:100%;height:100%;position:absolute;top:0;z-index:10}:host ::ng-deep .main-upload .custom-upload{background:transparent;flex-direction:row-reverse}:host ::ng-deep .main-upload-with-icon{text-align:center;max-width:200px;margin:auto}:host ::ng-deep .main-upload-with-icon .mat-input-element{text-align:left}:host ::ng-deep .show-img-preview{width:200px;height:200px;overflow:hidden;margin:auto}:host ::ng-deep .show-img-preview>img{width:100%;height:100%;object-fit:contain}:host ::ng-deep .mat-form-field-underline{display:none}:host ::ng-deep .mat-form-field-infix{border-bottom:none;display:flex;justify-content:center}:host ::ng-deep .mat-input-element{font-size:14px;margin-left:10px}:host ::ng-deep .mat-flat-button.mat-primary{background:transparent;padding:0;line-height:0}:host ::ng-deep .mat-toolbar-single-row{height:30px}:host ::ng-deep .mat-form-field-appearance-legacy .mat-form-field-wrapper{padding-bottom:0}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.FileUploadService }]; }, propDecorators: { showVisuelImg: [{
                type: Input
            }], withIcon: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXBsb2FkLWZpbGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvaWd5LXRlbXBsYXRlcy1tb2R1bGVzL3NyYy9saWIvY29tcG9zYW50cy91cGxvYWQtZmlsZS91cGxvYWQtZmlsZS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9pZ3ktdGVtcGxhdGVzLW1vZHVsZXMvc3JjL2xpYi9jb21wb3NhbnRzL3VwbG9hZC1maWxlL3VwbG9hZC1maWxlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxhQUFhLEVBQUUsWUFBWSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbkUsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFHekQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLDBCQUEwQixDQUFDOzs7Ozs7OztBQU8zRCxNQUFNLE9BQU8sbUJBQW1CO0lBWTlCLFlBQW9CLGFBQWdDO1FBQWhDLGtCQUFhLEdBQWIsYUFBYSxDQUFtQjtRQVgzQyxrQkFBYSxHQUFZLEtBQUssQ0FBQztRQUMvQixhQUFRLEdBQVksS0FBSyxDQUFDO1FBR25DLHNCQUFpQixHQUFhLEVBQUUsQ0FBQztRQUNqQyxrQkFBYSxHQUFVLEVBQUUsQ0FBQztRQUMxQixZQUFPLEdBQWEsRUFBRSxDQUFDO1FBQ3ZCLGFBQVEsR0FBYSxFQUFFLENBQUM7UUFFeEIsYUFBUSxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUM7SUFFcUIsQ0FBQztJQUV4RCxRQUFRO1FBQ04sSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQ2xELENBQUM7SUFFRCxXQUFXLENBQUMsS0FBVTtRQUNwQixJQUFJLENBQUMsT0FBTyxHQUFHLEVBQUUsQ0FBQztRQUNsQixJQUFJLENBQUMsYUFB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QUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUN2QztTQUNGO0lBQ0gsQ0FBQzs7Z0hBM0VVLG1CQUFtQjtvR0FBbkIsbUJBQW1CLHlIQ1hoQyxpN0JBY007MkZESE8sbUJBQW1CO2tCQUwvQixTQUFTOytCQUNFLGlCQUFpQjt3R0FLbEIsYUFBYTtzQkFBckIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cEV2ZW50VHlwZSwgSHR0cFJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBGaWxlVXBsb2FkU2VydmljZSB9IGZyb20gJy4vZmlsZS11cGxvYWQuc2VydmljZSc7XG5pbXBvcnQgeyBHbG9iYWxDb25zdGFudHMgfSBmcm9tICcuLy4uLy4uL2dsb2JhbC1jb25zdGFudHMnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdpZ3ktdXBsb2FkLWZpbGUnLFxuICB0ZW1wbGF0ZVVybDogJy4vdXBsb2FkLWZpbGUuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi91cGxvYWQtZmlsZS5jb21wb25lbnQuc2NzcyddLFxufSlcbmV4cG9ydCBjbGFzcyBVcGxvYWRGaWxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQElucHV0KCkgc2hvd1Zpc3VlbEltZzogYm9vbGVhbiA9IGZhbHNlO1xuICBASW5wdXQoKSB3aXRoSWNvbjogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHNlbGVjdGVkRmlsZXM/OiBGaWxlTGlzdDtcbiAgc2VsZWN0ZWRGaWxlTmFtZXM6IHN0cmluZ1tdID0gW107XG4gIHByb2dyZXNzSW5mb3M6IGFueVtdID0gW107XG4gIG1lc3NhZ2U6IHN0cmluZ1tdID0gW107XG4gIHByZXZpZXdzOiBzdHJpbmdbXSA9IFtdO1xuICBpbWFnZUluZm9zPzogT2JzZXJ2YWJsZTxhbnk+O1xuICBpbWFnZVVybCA9IEdsb2JhbENvbnN0YW50cy5pbWdVUkw7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSB1cGxvYWRTZXJ2aWNlOiBGaWxlVXBsb2FkU2VydmljZSkge31cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLmltYWdlSW5mb3MgPSB0aGlzLnVwbG9hZFNlcnZpY2UuZ2V0RmlsZXMoKTtcbiAgfVxuXG4gIHNlbGVjdEZpbGVzKGV2ZW50OiBhbnkpOiB2b2lkIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBbXTtcbiAgICB0aGlzLnByb2dyZXNzSW5mb3MgPSBbXTtcbiAgICB0aGlzLnNlbGVjdGVkRmlsZU5hbWVzID0gW107XG4gICAgdGhpcy5zZWxlY3RlZEZpbGVzID0gZXZlbnQudGFyZ2V0LmZpbGVzO1xuXG4gICAgdGhpcy5wcmV2aWV3cyA9IFtdO1xuICAgIGlmICh0aGlzLnNlbGVjdGVkRmlsZXMgJiYgdGhpcy5zZWxlY3RlZEZpbGVzWzBdKSB7XG4gICAgICBjb25zdCBudW1iZXJPZkZpbGVzID0gdGhpcy5zZWxlY3RlZEZpbGVzLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtYmVyT2ZGaWxlczsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cbiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChlOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgIHRoaXMucHJldmlld3MucHVzaChlLnRhcmdldC5yZXN1bHQpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKHRoaXMuc2VsZWN0ZWRGaWxlc1tpXSk7XG5cbiAgICAgICAgdGhpcy5zZWxlY3RlZEZpbGVOYW1lcy5wdXNoKHRoaXMuc2VsZWN0ZWRGaWxlc1tpXS5uYW1lKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB1cGxvYWQoaWR4OiBudW1iZXIsIGZpbGU6IEZpbGUpOiB2b2lkIHtcbiAgICB0aGlzLnByb2dyZXNzSW5mb3NbaWR4XSA9IHsgdmFsdWU6IDAsIGZpbGVOYW1lOiBmaWxlLm5hbWUgfTtcblxuICAgIGlmIChmaWxlKSB7XG4gICAgICB0aGlzLnVwbG9hZFNlcnZpY2UudXBsb2FkKGZpbGUpLnN1YnNjcmliZShcbiAgICAgICAgKGV2ZW50OiBhbnkpID0+IHtcbiAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gSHR0cEV2ZW50VHlwZS5VcGxvYWRQcm9ncmVzcykge1xuICAgICAgICAgICAgdGhpcy5wcm9ncmVzc0luZm9zW2lkeF0udmFsdWUgPSBNYXRoLnJvdW5kKFxuICAgICAgICAgICAgICAoMTAwICogZXZlbnQubG9hZGVkKSAvIGV2ZW50LnRvdGFsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQgaW5zdGFuY2VvZiBIdHRwUmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnN0IG1zZyA9ICdVcGxvYWRlZCB0aGUgZmlsZSBzdWNjZXNzZnVsbHk6ICcgKyBmaWxlLm5hbWU7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UucHVzaChtc2cpO1xuICAgICAgICAgICAgdGhpcy5pbWFnZUluZm9zID0gdGhpcy51cGxvYWRTZXJ2aWNlLmdldEZpbGVzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICAoZXJyOiBhbnkpID0+IHtcbiAgICAgICAgICB0aGlzLnByb2dyZXNzSW5mb3NbaWR4XS52YWx1ZSA9IDA7XG4gICAgICAgICAgY29uc3QgbXNnID0gJ0NvdWxkIG5vdCB1cGxvYWQgdGhlIGZpbGU6ICcgKyBmaWxlLm5hbWU7XG4gICAgICAgICAgdGhpcy5tZXNzYWdlLnB1c2gobXNnKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICB1cGxvYWRGaWxlcygpOiB2b2lkIHtcbiAgICB0aGlzLm1lc3NhZ2UgPSBbXTtcblxuICAgIGlmICh0aGlzLnNlbGVjdGVkRmlsZXMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zZWxlY3RlZEZpbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMudXBsb2FkKGksIHRoaXMuc2VsZWN0ZWRGaWxlc1tpXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iLCI8bWF0LWZvcm0tZmllbGQ+XHJcbiAgICA8ZGl2IGNsYXNzPVwibWFpbi11cGxvYWRcIiBbbmdDbGFzc109XCJ7J21haW4tdXBsb2FkLXdpdGgtaWNvbic6IHdpdGhJY29ufVwiPlxyXG4gICAgICAgIDxpbWcgc3JjPVwie3tpbWFnZVVybH19L2ljb25zL2FrYXItaWNvbnNfY2lyY2xlLXBsdXMuc3ZnXCIgYWx0PVwiUGx1c1wiICpuZ0lmPVwid2l0aEljb25cIj5cclxuICAgICAgICA8bWF0LXRvb2xiYXIgY2xhc3M9XCJjdXN0b20tdXBsb2FkXCI+XHJcbiAgICAgICAgICAgIDxpbnB1dCBtYXRJbnB1dCBbdmFsdWVdPVwic2VsZWN0ZWRGaWxlTmFtZXMubGVuZ3RoID8gc2VsZWN0ZWRGaWxlTmFtZXMgOiAnQ2hvaXNpciB1biBmaWNoaWVyJ1wiIC8+XHJcbiAgICAgICAgICAgIDxidXR0b24gbWF0LWZsYXQtYnV0dG9uIGNvbG9yPVwicHJpbWFyeVwiIFtkaXNhYmxlZF09XCIhc2VsZWN0ZWRGaWxlc1wiIChjbGljayk9XCJ1cGxvYWRGaWxlcygpXCI+XHJcbiAgICAgICAgPGltZyBzcmM9XCJ7e2ltYWdlVXJsfX0vaWNvbnMvdXBsb2FkRmlsZS5zdmdcIiBhbHQ9XCJJY29uc1wiPlxyXG4gICAgICA8L2J1dHRvbj5cclxuICAgICAgICA8L21hdC10b29sYmFyPlxyXG4gICAgICAgIDxpbnB1dCBjbGFzcz1cImluaXRpYWwtdXBsb2FkXCIgdHlwZT1cImZpbGVcIiBpZD1cImZpbGVJbnB1dFwiIG5hbWU9XCJmaWxlSW5wdXRcIiBhY2NlcHQ9XCJpbWFnZS8qXCIgbXVsdGlwbGUgKGNoYW5nZSk9XCJzZWxlY3RGaWxlcygkZXZlbnQpXCIgLz5cclxuICAgIDwvZGl2PlxyXG48L21hdC1mb3JtLWZpZWxkPlxyXG48ZGl2ICpuZ0lmPVwic2hvd1Zpc3VlbEltZ1wiIGNsYXNzPVwic2hvdy1pbWctcHJldmlld1wiPlxyXG4gICAgPGltZyAqbmdGb3I9J2xldCBwcmV2aWV3IG9mIHByZXZpZXdzJyBbc3JjXT1cInByZXZpZXdcIiBjbGFzcz1cInByZXZpZXdcIj5cclxuPC9kaXY+Il19